import requests
import json

url = "https://valvir-opus.tracelink.com/api/graphql"

payload = "{\"query\":\"query readIncident($type: String!, $id: String!)\\n{\\n    genericGetObject(type:$type, id: $id)\\n    {\\n        ... on ALL_RETURNS {\\n            ... on DirectSupplierIncident {\\n                id\\n                currentBaseState\\n                currentSubState\\n                data {\\n                    aptBusinessObjectId\\n                    aptBusinessObjectSummary\\n                    aptBusinessObjectDescription\\n                    responsibleDepartmentAtCompany\\n                    responsibleDepartmentAtPartner\\n                    incidentType\\n                    resolutionDueDate\\n                    directSupplierImpact{\\n                        businessPriority\\n                    }\\n                    referenceIdentifiers {\\n                        value\\n                        referenceTransactionType\\n                        __typename\\n                    }\\n                    dateSubmitted\\n                    createdByPartner\\n                    __typename\\n                }\\n                aptBusinessObjectBelongsToProcessNetwork {\\n                    to {\\n                        ... on ProcessNetwork {\\n                            id\\n                            __typename\\n                        }\\n                        __typename\\n                    }\\n                    __typename\\n                }\\n                aptBusinessObjectCompanyAssignedUser {\\n                    to {\\n                        ... on User {\\n                            ...userName\\n                            __typename\\n                        }\\n                        __typename\\n                    }\\n                    __typename\\n                }\\n                aptBusinessObjectPartnerAssignedUser {\\n                    to {\\n                        ... on User {\\n                            ...userName\\n                            __typename\\n                        }\\n                        __typename\\n                    }\\n                    __typename\\n                }\\n                aptBusinessObjectCompanyOwnerUser {\\n                    to {\\n                        ... on User {\\n                            ...userName\\n                            __typename\\n                        }\\n                        __typename\\n                    }\\n                    __typename\\n                }\\n                aptBusinessObjectPartnerOwnerUser {\\n                    to {\\n                        ... on User {\\n                            ...userName\\n                            __typename\\n                        }\\n                        __typename\\n                    }\\n                    __typename\\n                }\\n                aptBusinessObjectAssignedToCompanyPartnerMasterData {\\n                    to {\\n                        ... on PartnerLocationMasterData {\\n                            id\\n                            data {\\n                                businessMasterDataCommon {\\n                                    businessName\\n                                    businessAddress {\\n                                        address1\\n                                        address2\\n                                        city\\n                                        district\\n                                        village\\n                                        houseNumber\\n                                        township\\n                                        state\\n                                        postalCode\\n                                        country\\n                                        __typename\\n                                    }\\n                                    __typename\\n                                }\\n                                __typename\\n                            }\\n                            __typename\\n                        }\\n                        ... on PartnerMasterData {\\n                            id\\n                            data {\\n                                businessMasterDataCommon {\\n                                    businessName\\n                                    businessAddress {\\n                                        address1\\n                                        address2\\n                                        city\\n                                        district\\n                                        village\\n                                        houseNumber\\n                                        township\\n                                        state\\n                                        postalCode\\n                                        country\\n                                        __typename\\n                                    }\\n                                    __typename\\n                                }\\n                                __typename\\n                            }\\n                            __typename\\n                        }\\n                        ... on CompanyLocationMasterData {\\n                            id\\n                            data {\\n                                businessMasterDataCommon {\\n                                    businessName\\n                                    businessAddress {\\n                                        address1\\n                                        address2\\n                                        city\\n                                        district\\n                                        village\\n                                        houseNumber\\n                                        township\\n                                        state\\n                                        postalCode\\n                                        country\\n                                        __typename\\n                                    }\\n                                    __typename\\n                                }\\n                                __typename\\n                            }\\n                            __typename\\n                            }\\n                            ... on CompanyMasterData{\\n                                id\\n                                data {\\n                                    businessMasterDataCommon {\\n                                        businessName\\n                                        businessAddress {\\n                                            address1\\n                                            address2\\n                                            city\\n                                            district\\n                                            village\\n                                            houseNumber\\n                                            township\\n                                            state\\n                                            postalCode\\n                                            country\\n                                            __typename\\n                                        }\\n                                        __typename\\n                                    }\\n                                    __typename\\n                                }\\n                                __typename\\n                            }\\n                            __typename\\n                        }\\n                        __typename\\n                    }\\n                aptBusinessObjectPrimaryPartnerLocationMasterData {\\n                    to {\\n                        ... on PartnerLocationMasterData {\\n                            id\\n                            data {\\n                                businessMasterDataCommon {\\n                                    businessName\\n                                    businessAddress {\\n                                        address1\\n                                        address2\\n                                        city\\n                                        district\\n                                        village\\n                                        houseNumber\\n                                        township\\n                                        state\\n                                        postalCode\\n                                        country\\n                                        __typename\\n                                    }\\n                                    __typename\\n                                }\\n                                __typename\\n                            }\\n                            __typename\\n                        }\\n                        __typename\\n                    }\\n                    __typename\\n                }\\n                __typename\\n            }\\n        __typename\\n    }\\n        __typename\\n    }    \\n}\\nfragment userName on User {\\n    id\\n    data {\\n        givenName\\n        surname\\n        __typename\\n    }\\n    __typename\\n} \",\"variables\":{\"type\":\"DirectSupplierIncident\",\"id\":\"YOUR_ID\"}}"
headers = {
  'Authorization': 'Basic YOUR_TOKEN',
  'Content-Type': 'application/json',
  'Dataspace': 'default',
  'companyId': 'YOUR_COMPANY_ID',
  'processNetworkId': 'YOUR_PROCESS_NETWORK_ID'
}

response = requests.request("POST", url, headers=headers, data=payload)

# adding some parsing to beautify the results
# print(response.text)
raw_json = json.loads(response.text)  # load the text result to into json

# schema_json = raw_json.get('data').get('genericActionCall')  # drill into object
schema_json = raw_json.get('data').get('genericGetObject') # use this for getObjectCalls
# api_json = json.loads(schema_json.get('result'))  # load the result object to json

# for genericGetObject, use schema_json. for genericActionCall, use api_json.
print(json.dumps(schema_json, indent=4, sort_keys=False))  # 'pretty print' the result
